<!DOCTYPE html>

<html>

<head>

    <title> AJAX </title>

</head>


<body onload="init()">

    <script type="text/javascript">
        function init() {
            var http = new XMLHttpRequest();
            var url = '/init';

            http.open('GET', url, true);
            http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            http.onreadystatechange = function () {
                if (http.readyState == 4 && http.status == 200) {

                    var response = JSON.parse(http.responseText);

                    document.getElementById("answer").value = response.answer;
                }
            };
            http.send();
            setTimeout('init()', 3000);
        }

        function sayHello() {
            var http = new XMLHttpRequest();
            var url = '/sayHello';
            var params = 'topic=' + document.getElementById("input").value
                + '&data=' + document.getElementById("data").value;

            http.open('POST', url, true);
            http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            http.onreadystatechange = function () {
                if (http.readyState == 4 && http.status == 200) {

                    var response = JSON.parse(http.responseText);

                    document.getElementById("answer").value = response.answer;
                }
            };
            http.send(params);
            let date_ob = new Date();
            alert("Post added!");
        }

        function sortTable() {
            var form = document.querySelector("form");
            let data = new FormData(form);
            var params = 'sortBy=' + data.get("sortBy")
                + '&sortOrder=' + data.get("sortOrder");

            var http = new XMLHttpRequest();
            var url = '/sortTable';

            http.open('PUT', url, true);
            http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            http.send(params);
        }



    </script>


    <label for="topic"> Topic:</label><br> <br>
    <input id="input" type="text" name="topic" value=""><br> <br>

    <label for="data"> Data:</label><br> <br>
    <textarea id="data" name="data" rows="10" cols="30"></textarea>

    <br>
    <button onclick="sayHello()"> Submit </button>
    <br>

    <label for="posts"> Posts:</label><br> <br>

    <form id="form">
        <p>Sort by:</p>
          <input type="radio" id="topicButton" name="sortBy" value="topic">
          <label for="topicButton">Topic</label><br>
          <input type="radio" id="timestampButton" name="sortBy" value="timestamp">
          <label for="timestampButton">Timestamp</label><br>

        <p>Sort order:</p>
          <input type="radio" id="ascendingButton" name="sortOrder" value="ASC">
          <label for="ascendingButton">Ascending order</label><br>
          <input type="radio" id="descendingButton" name="sortOrder" value="DESC">
          <label for="descendingButton">Descending order</label><br>
    </form>

    <br>
    <button onclick="sortTable()"> Sort </button>
    <br>

    <textarea id="answer" rows="50" cols="30"></textarea>

</body>

</html>